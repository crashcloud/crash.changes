---
name: DeployNuget
on:
  push:
    branches:
      - main
    paths:
        - '.github/workflows/deploy-nuget.yml'
        - 'src/*.csproj'

jobs:
    build:
        runs-on: ubuntu-latest
        steps:
        - uses: actions/checkout@v3
    
        - uses: actions/setup-dotnet@v3
          with:
            dotnet-version: |
              6.0
        
        - name: Build & Publish Nuget
          id: publish_nuget
          run: |
            dotnet build src/*.csproj --configuration Release --no-restore
            dotnet pack src/*.csproj --configuration Release --no-build --no-restore -o ./artifacts
            dotnet nuget push ./artifacts/*.nupkg --api-key ${{ secrets.GITHUB_TOKEN }} --source "github"        
